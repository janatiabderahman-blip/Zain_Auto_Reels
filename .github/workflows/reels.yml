name: Zain_Auto_Reels_Pro

on:
  workflow_dispatch:        # ÙŠØªÙŠØ­ Ù„Ùƒ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨ÙˆØª ÙŠØ¯ÙˆÙŠØ§Ù‹ Ù„Ù„ØªØ¬Ø±Ø¨Ø©
  push:
    branches: [ main ]      # ÙŠØ¹Ù…Ù„ Ø¹Ù†Ø¯ Ø±ÙØ¹ Ø£ÙŠ ØªØ­Ø¯ÙŠØ« Ù„Ù„ÙƒÙˆØ¯
  schedule:
    - cron: "0 */3 * * *"   # ÙŠØ¹Ù…Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ ÙƒÙ„ 3 Ø³Ø§Ø¹Ø§Øª

jobs:
  run-bot:
    runs-on: ubuntu-latest
    # Ù†Ø­Ø¯Ø¯ Ø§Ù„Ù…Ù‡Ù„Ø© Ø§Ù„Ù‚ØµÙˆÙ‰ Ø¨Ù€ 15 Ø¯Ù‚ÙŠÙ‚Ø© Ù„Ø¶Ù…Ø§Ù† Ø¹Ø¯Ù… ØªØ¹Ù„ÙŠÙ‚ Ø§Ù„Ø¹Ù…Ù„
    timeout-minutes: 15

    steps:
      - name: ğŸ” Trigger info
        run: |
          echo "Event: ${{ github.event_name }}"
          echo "Actor: ${{ github.actor }}"
          echo "Time: $(date)"

      - name: ğŸ“¦ Checkout repository
        uses: actions/checkout@v4  # Ù‡Ø°Ø§ Ø§Ù„Ø³Ø·Ø± Ø¶Ø±ÙˆØ±ÙŠ Ø¬Ø¯Ø§Ù‹ Ù„Ø³Ø­Ø¨ Ù…Ù„ÙØ§ØªÙƒ (main.py) Ù„Ù„Ø¨ÙŠØ¦Ø©

      - name: ğŸ Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: "3.11"

      - name: ğŸ›  Install system dependencies (FFmpeg)
        run: |
          sudo apt-get update
          sudo apt-get install -y ffmpeg

      - name: ğŸ“š Install Python dependencies
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt

      - name: ğŸš€ Execution (AI Generation & Upload)
        env:
          # Ø±Ø¨Ø· Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙØ§ØªÙŠØ­ Ø§Ù„ØªÙŠ Ø£Ø¶ÙØªÙ‡Ø§ ÙÙŠ Secrets
          FB_TOKEN: ${{ secrets.FB_TOKEN }}
          PAGE_ID:  ${{ secrets.PAGE_ID }}
          GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
          PEXELS_API_KEY: ${{ secrets.PEXELS_API_KEY }}
        run: |
          echo "=== Starting AI Reel Process ==="
          python main.py
          echo "=== Process Finished ==="

      - name: âœ… Job Completed
        if: always()
        run: echo "Zain_Auto_Reels workflow finished."
