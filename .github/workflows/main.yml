import os
import requests
import random

# Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªÙŠ ÙˆØ¶Ø¹ØªÙ‡Ø§
TOKEN = os.getenv('FB_TOKEN')
PAGE_ID = os.getenv('PAGE_ID')

# ÙƒÙ„Ù…Ø§Øª Ø¨Ø­Ø« Ù…ØªÙ†ÙˆØ¹Ø© Ù„Ø¶Ù…Ø§Ù† ÙˆØ¬ÙˆØ¯ ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ø¯Ø§Ø¦Ù…Ø§Ù‹
search_queries = ["satisfying gadgets shorts", "amazing inventions shorts", "funny cat shorts", "life hacks shorts"]
query = random.choice(search_queries)

print(f"ğŸš€ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† ÙÙŠØ¯ÙŠÙˆ Ø¬Ø¯ÙŠØ¯ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙƒÙ„Ù…Ø©: {query}")

# Ø§Ù„Ø£Ù…Ø± Ø§Ù„Ø³Ø­Ø±ÙŠ: ÙŠØ¨Ø­Ø« ÙÙŠ 40 ÙÙŠØ¯ÙŠÙˆ ÙˆÙŠØ®ØªØ§Ø± Ø£ÙˆÙ„ ÙˆØ§Ø­Ø¯ Ø£Ù‚Ù„ Ù…Ù† 60 Ø«Ø§Ù†ÙŠØ© ÙˆØ¨ØµÙŠØºØ© mp4
download_cmd = f"yt-dlp -f 'best[ext=mp4]' --max-downloads 1 --match-filter 'duration < 60' -o 'video.mp4' 'ytsearch40:{query}'"

os.system(download_cmd)

# Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ØªÙ… ØªØ­Ù…ÙŠÙ„Ù‡ Ø¨Ù†Ø¬Ø§Ø­
if os.path.exists('video.mp4'):
    print("âœ… ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ÙÙŠØ¯ÙŠÙˆ Ù…Ù†Ø§Ø³Ø¨ ÙˆØªØ­Ù…ÙŠÙ„Ù‡!")
    
    url = f"https://graph.facebook.com/v19.0/{PAGE_ID}/videos"
    files = {'source': open('video.mp4', 'rb')}
    data = {
        'description': 'Amazing Gadgets & Shorts! âœ¨ #shorts #reels #viral',
        'access_token': TOKEN
    }
    
    response = requests.post(url, files=files, data=data)
    
    if response.status_code == 200:
        print(f"ğŸ‰ ØªÙ… Ø§Ù„Ù†Ø´Ø± Ø¨Ù†Ø¬Ø§Ø­! ID Ø§Ù„ÙÙŠØ¯ÙŠÙˆ: {response.json().get('id')}")
    else:
        print(f"âŒ ÙØ´Ù„ Ø§Ù„Ù†Ø´Ø±. Ø±Ø¯ ÙÙŠØ³Ø¨ÙˆÙƒ: {response.text}")
else:
    print("âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ÙÙŠØ¯ÙŠÙˆ Ù‚ØµÙŠØ± ÙÙŠ Ø£ÙˆÙ„ 40 Ù†ØªÙŠØ¬Ø©ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.")
